# Задачи по реализации административной панели (фронт)

1. **Главная страница админки (Dashboard)**
   - Отображение ключевых метрик и статусов системы.
2. **Управление пользователями**
   - Просмотр списка пользователей.
   - Создание нового пользователя.
   - Редактирование пользователя.
   - Удаление пользователя.
3. **Управление ролями и правами доступа**
   - Просмотр и редактирование ролей.
   - Назначение ролей пользователям.
4. **Управление платформами**
   - Просмотр списка платформ.
   - Добавление новой платформы.
   - Редактирование платформы.
   - Удаление платформы.
5. **Просмотр и фильтрация логов системы (Audit Log)**
   - Просмотр истории действий пользователей и системных событий.
   - Фильтрация и поиск по логам.
6. **Управление устройствами и командами**
   - Просмотр устройств.
   - Отправка команд на устройства.
   - Просмотр истории команд.
7. **Просмотр статуса системы и лимитов**
   - Отображение текущего состояния сервисов.
   - Просмотр лимитов и ограничений.
8. **Навигация (Sidebar, Header)**
   - Реализация бокового меню и шапки для удобной навигации.
9. **Уведомления и алерты**
   - Настройка и отображение уведомлений для администратора.
10. **Интеграция с backend API**
    - Реализация всех необходимых запросов к backend (авторизация, CRUD).
11. **Тестирование и отладка**
    - Проверка всех функций админки на корректность работы.
# План реализации административной панели (фронт)

## 1. Архитектура и структура проекта
- Проверить и при необходимости доработать структуру папок и компонентов для админки.
- Определить основные маршруты (routes) для страниц админки.

## 2. UI/UX прототипирование
- Составить схему навигации (Sidebar, Header).
- Определить макеты для основных страниц (Dashboard, Users, Platforms, Logs и т.д.).

## 3. Реализация основных страниц
- Dashboard: ключевые метрики, статус системы.
- Users: CRUD пользователей, фильтрация, поиск.
- Roles: управление ролями и правами.
- Platforms: CRUD платформ.
- Logs: просмотр и фильтрация логов.
- Devices/Commands: управление устройствами и командами.
- System Status: отображение статусов и лимитов.

## 4. Интеграция с backend API
- Настроить авторизацию и защиту маршрутов.
- Реализовать запросы к backend для всех сущностей (users, roles, platforms, logs и т.д.).

## 5. Навигация и общие компоненты
- Sidebar, Header, NotificationProvider.
- Реализация алертов и уведомлений.

## 6. Тестирование и отладка
- Покрыть основные сценарии тестами.
- Проверить корректность работы всех функций.

## 7. Документация
- Описать структуру админки и основные сценарии использования.
# Рефлексия по задаче: "Реализация и отладка страницы управления шаблонами команд"

## 1. Что получилось хорошо? (Successes)

- **Комплексная диагностика и решение:** Успешно пройдена вся цепочка проблем: от неверного параметра в URL на фронтенде, через отсутствующий роутер и ошибки импортов на бэкенде, до проблем с асинхронными данными и бесконечным циклом рендеринга на фронтенде.
- **Восстановление дизайна:** Удалось быстро и точно воссоздать требуемый двухэтапный интерфейс по скриншотам, что значительно улучшило пользовательский опыт.
- **Ключевое исправление производительности:** Определение и устранение причины бесконечных запросов к API с помощью `useMemo` было критически важным для стабилизации приложения.
- **Быстрая реализация бэкенда:** После обнаружения отсутствия эндпоинта для шаблонов команд, необходимый CRUD-функционал на FastAPI был создан очень оперативно.

## 2. С какими трудностями мы столкнулись? (Challenges)

- **Каскадные ошибки:** Проблема была не одна, а целая серия связанных друг с другом сбоев, где исправление одной ошибки приводило к проявлению следующей.
- **Несоответствие контракта данных:** Ошибка `reading 'map'` возникла из-за того, что фронтенд ожидал данные в одном формате (`response.data`), а хук `useApi` возвращал их в другом.
- **Нестабильность кастомного хука:** Проблема с бесконечной перезагрузкой показала, что кастомный хук `useApi` создавал новые экземпляры функций при каждом рендере.

## 3. Какие уроки мы извлекли? (Lessons Learned)

- **Важность стабильности хуков:** Практически убедились, что кастомные хуки в React, возвращающие объекты или функции (как `useApi`), обязательно нужно оборачивать в `useMemo` или `useCallback` для предотвращения бесконечных циклов `useEffect`.
- **Тщательная проверка "контракта" API:** Ошибка `.map of undefined` стала напоминанием о важности синхронизации представлений о структуре данных между клиентом и сервером.
- **Изолированная проверка бэкенда:** Новые эндпоинты стоит сначала проверять отдельно (например, через Swagger UI), прежде чем интегрировать с фронтендом, чтобы быстрее выявлять ошибки на стороне сервера.

## 4. Что можно улучшить в будущем? (Process/Technical Improvements)

- **Стандартизировать хук `useApi`:** Доработать хук `useApi`, чтобы он по умолчанию возвращал стабильные (мемоизированные) объекты и функции, сделав это системным решением.
- **Генерация типов из схемы API:** Настроить автоматическую генерацию TypeScript-типов из OpenAPI схемы бэкенда для избежания ошибок несоответствия данных.
