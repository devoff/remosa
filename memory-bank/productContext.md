# Контекст продукта: Система мониторинга и автоматизации REMOSA

## Бизнес-логика

### Основной процесс мониторинга:
1. **Setup**: Супер админ создает платформу для клиента
2. **Configuration**: Администратор платформы настраивает устройства и алерты
3. **Monitoring**: Grafana мониторит устройства клиента
4. **Alert**: При проблеме Grafana отправляет алерт
5. **Processing**: Система обрабатывает алерт
6. **Action**: Отправляется SMS-команда на устройство управления
7. **Execution**: Устройство выполняет действие (перезагрузка/выключение)
8. **Logging**: Все действия логируются для аудита

### Ключевые сущности:
- **Платформы**: Изолированные среды для клиентов с лимитами по устройствам и SMS
- **Устройства**: Объекты мониторинга и управления
- **Команды**: Действия для управления устройствами
- **Алерты**: Уведомления о проблемах
- **Шаблоны**: Предустановленные конфигурации
- **Задания (Jobs)**: Автоматизированные задачи мониторинга и управления
- **Экспортеры**: Компоненты для сбора метрик с устройств

### Типы пользователей:
- **superadmin**: Полный доступ к системе, управление платформами и лимитами
- **admin**: Администратор платформы, управляет пользователями и устройствами в своей платформе
- **manager**: Менеджер платформы, управляет устройствами и пользователями
- **user**: Пользователь, может управлять только своими устройствами
- **viewer**: Только просмотр данных

### Ценностное предложение:
- Автоматизация реагирования на инциденты
- Централизованное управление устройствами
- Мультитенантная архитектура
- Интеграция с существующими системами мониторинга
- Prometheus-based мониторинг
- Автоматизированные задания

### Автоматизация управления и мониторинга (REMOSA, 2025)

#### Устройства управления
- Это устройства типа «умная розетка» с SIM-картой.
- Управляются через SMS-шлюз: отправляются команды (например, перезагрузка устройств мониторинга, включение/выключение и др.).
- Для них реализованы:
  - Отправка SMS-команд через шлюз.
  - Система шаблонов SMS-команд (выбор и отправка готовых шаблонов).
  - Вся логика управления и взаимодействия с этими устройствами работает и протестирована.

#### Устройства мониторинга
- Это устройства, которые система мониторит (например, по статусу, метрикам Prometheus и т.д.).
- Их задача — предоставлять данные о состоянии, которые используются для принятия решений.

#### Автоматизация управления (текущая задача)
- Реализуется система, при которой при срабатывании определённого триггера (условия на устройстве мониторинга) автоматически отправляется команда на устройство управления.
- Пример: если устройство мониторинга стало OFFLINE или метрика вышла за пределы — система сама отправляет нужную SMS-команду на устройство управления.
- Вся логика автоматизации реализуется на backend (FastAPI + AsyncIO), триггеры и действия настраиваются через UI.

#### Система заданий (Jobs)
- **Automated Jobs**: Задания с расписанием для автоматического выполнения
- **Prometheus Monitoring**: Мониторинг метрик Prometheus с условиями и действиями
- **Device Commands**: Автоматические команды на устройства при срабатывании условий
- **Platform Isolation**: Задания изолированы по платформам

#### Экспортеры
- **CubicExporter**: Экспортер для устройств Cubic
- **Platform Exporters**: Экспортеры, привязанные к платформам
- **Metrics Collection**: Сбор метрик с различных устройств
