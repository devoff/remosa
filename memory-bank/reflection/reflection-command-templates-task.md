# Рефлексия по задаче: "Реализация и отладка страницы управления шаблонами команд"

## 1. Что получилось хорошо? (Successes)

- **Комплексная диагностика и решение:** Успешно пройдена вся цепочка проблем: от неверного параметра в URL на фронтенде, через отсутствующий роутер и ошибки импортов на бэкенде, до проблем с асинхронными данными и бесконечным циклом рендеринга на фронтенде.
- **Восстановление дизайна:** Удалось быстро и точно воссоздать требуемый двухэтапный интерфейс по скриншотам, что значительно улучшило пользовательский опыт.
- **Ключевое исправление производительности:** Определение и устранение причины бесконечных запросов к API с помощью `useMemo` было критически важным для стабилизации приложения.
- **Быстрая реализация бэкенда:** После обнаружения отсутствия эндпоинта для шаблонов команд, необходимый CRUD-функционал на FastAPI был создан очень оперативно.

## 2. С какими трудностями мы столкнулись? (Challenges)

- **Каскадные ошибки:** Проблема была не одна, а целая серия связанных друг с другом сбоев, где исправление одной ошибки приводило к проявлению следующей.
- **Несоответствие контракта данных:** Ошибка `reading 'map'` возникла из-за того, что фронтенд ожидал данные в одном формате (`response.data`), а хук `useApi` возвращал их в другом.
- **Нестабильность кастомного хука:** Проблема с бесконечной перезагрузкой показала, что кастомный хук `useApi` создавал новые экземпляры функций при каждом рендере.

## 3. Какие уроки мы извлекли? (Lessons Learned)

- **Важность стабильности хуков:** Практически убедились, что кастомные хуки в React, возвращающие объекты или функции (как `useApi`), обязательно нужно оборачивать в `useMemo` или `useCallback` для предотвращения бесконечных циклов `useEffect`.
- **Тщательная проверка "контракта" API:** Ошибка `.map of undefined` стала напоминанием о важности синхронизации представлений о структуре данных между клиентом и сервером.
- **Изолированная проверка бэкенда:** Новые эндпоинты стоит сначала проверять отдельно (например, через Swagger UI), прежде чем интегрировать с фронтендом, чтобы быстрее выявлять ошибки на стороне сервера.

## 4. Что можно улучшить в будущем? (Process/Technical Improvements)

- **Стандартизировать хук `useApi`:** Доработать хук `useApi`, чтобы он по умолчанию возвращал стабильные (мемоизированные) объекты и функции, сделав это системным решением.
- **Генерация типов из схемы API:** Настроить автоматическую генерацию TypeScript-типов из OpenAPI схемы бэкенда для избежания ошибок несоответствия данных.
